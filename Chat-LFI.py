from functions import *
import json
import os


try:openai.api_key = st.secrets["OPENAI_API_KEY"]
except: openai.api_key = os.environ['OPENAI_API_KEY']

st.set_page_config(
    page_title="Chat-LFI",
    page_icon="data:image/jpeg;base64,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",
    layout="wide",
    initial_sidebar_state="expanded",
)

st.sidebar.image('https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/LogoNUPES.svg/1280px-LogoNUPES.svg.png')
st.title("NUPES 2022")


if st.checkbox("Afficher le programme partagé de gouvernement​"):
    st.markdown("""
Le programme partagé de gouvernement ici présenté est le fruit d’un travail collectif associant plusieurs organisations politiques, sur la base de programmes eux-mêmes élaborés en associant des milliers de citoyennes et citoyens, acteurs associatifs, syndicaux, environnementaux, politiques.

Il sera la feuille de route partagée du gouvernement de la Nouvelle Union populaire écologique et sociale. Notre majorité parlementaire sera composée à l’Assemblée nationale de plusieurs groupes politiques réunis au sein d’un intergroupe. Il servira de lieu de discussion et de coordination permanente entre ses différentes composantes. Cette majorité soutiendra ensemble l’action du gouvernement, notamment en votant pour les budgets et les projets législatifs présentés qui émanent des propositions de ce programme partagé.

Mais dans notre conception de la République, le rôle des députés, représentants du peuple, ne saurait se limiter à soutenir l’action d’un gouvernement. Nous ne voulons pas reproduire les mécanismes de la monarchie présidentielle et de ses majorités godillotes. Cette logique solitaire et verticale du pouvoir a été poussée à l’extrême par Emmanuel Macron. Il nous faut en sortir. Nous défendons une pratique démocratique des institutions où le Parlement est l’endroit par excellence où les décisions sont élaborées, délibérées et prises. Nous souhaitons ainsi que l’intergroupe puisse être le lieu d’élaboration de propositions de lois au-delà même de celles prévues par ce programme partagé, ainsi qu’un lieu de débat, d’échange et de décision. 

Nous ferons une grande place dans les travaux législatifs de l’Assemblée, à l’initiative parlementaire. La majorité parlementaire de la Nouvelle Union populaire écologique et sociale conservera tout au long du mandat des liens très forts avec la société active et notamment le monde syndical, associatif, les organisations non gouvernementales (ONG), les collectifs en lutte, les intellectuels, etc. Son intergroupe se réunira régulièrement avec le Parlement de la Nouvelle Union populaire écologique et sociale pour nourrir le débat parlementaire des aspirations et des réflexions de ces forces vives.

Cette méthode générale, nous nous l’appliquons à nous-mêmes. Ce cadre permettra de combiner la diversité des expressions et la cohérence des décisions. Nous avons refusé les facilités des synthèses sans contenu pour masquer les désaccords lorsque nous ne sommes pas parvenus à les surmonter dans le bref délai dont nous disposions. En effet, sur quelques points du programme partagé de gouvernement – 33 sur 650 –, des organisations politiques qui soutiennent ce programme porteront dans le débat parlementaire des propositions pour les préciser ou les nuancer. Leur liberté de vote sera respectée. Nous n’avons rien voulu cacher sur ce sujet et c’est pourquoi, si limités qu’ils soient, ces points sont consignés à la fin de chaque chapitre du programme partagé de gouvernement. Ils seront donc soumis au débat de l’intergroupe et à la sagesse de l’Assemblée.""")

with open('programme_LFI.json', 'r') as fp:
    programme_LFI = json.load(fp)
st.title("Chat-LFI")
keys_programme = st.selectbox('Select a question', options=list(programme_LFI.keys()))

question = st.text_input('Possez votre question')
if st.button('Envoyer votre question'):
    answer = chat(programme_LFI[keys_programme], question)
    st.write(answer)